<!-- wp:list {"ordered":true} -->
<ol><!-- wp:list-item -->
<li><strong>点名功能：可以单人抽取或选择抽取多人(不重复)，实现随机点名的功能。</strong></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>名单管理：软件提供了名单管理功能，用户可以通过编辑名单功能来自定义点名名单。</strong></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>多名单功能： 用户可以创建多个名单并切换名单，实现在不同场景下使用不同名单的需求。</strong></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>自动检查更新： 软件支持自动检查更新，用户可以通过配置文件关闭更新提示。</strong></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>UI优化和用户体验：软件界面经过多次优化，基本达到能看的程度...</strong></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>导出功能： 用户可以将点名的历史记录导出为图表或文本，方便记录和分析。</strong></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>背景音乐：软件支持单抽时的背景音乐，用户可以在按照提示开启该功能。</strong></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>零付费，零广告，完全开源，教师可私信免费获取定制版本</strong></li>
<!-- /wp:list-item --></ol>
<!-- /wp:list -->

<!-- wp:paragraph {"style":{"typography":{"fontSize":"28px"}}} -->
<p style="font-size:28px"><a rel="noreferrer noopener" href="https://yish.lanzouw.com/b038hjo8f" data-type="URL" data-id="https://yish.lanzouw.com/b038hjo8f" target="_blank"><strong>最新版下载地址</strong></a>密码:cmti</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size">停更通知：如果没有严重Bug被发现、或者新的想法出现，那么我们将不会再更新点名器了，感谢您的支持！</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size">更新时请备份名单，然后卸载旧版本重新安装，否则可能出现错误</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>4.6版本最后支持32位系统<s>https://github.com/Yish1/ktdmq/releases/download/4.3/4.3.exe</s>32位版5.8正在准备中，敬请期待</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"textColor":"vivid-red"} -->
<p class="has-vivid-red-color has-text-color">提示：4.8起更换了打包方式，改成安装包的形式，因此你可以在安装4.8后删除4.7，也可以安装到u盘里面便携使用</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size"><strong><a rel="noreferrer noopener" href="https://yish.lanzouw.com/izsZF0fv96jg" data-type="URL" data-id="https://yish.lanzouw.com/izsZF0fv96jg" target="_blank">下载通用版4.9（最后的单文件版）</a></strong></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">5.8版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2023.11.19<br>1.新增首次开启时的检查更新开关<br>2.删除使用率较低的功能(保存为图表)<br>3.使用nuitka打包，大幅降低程序占用空间(44mb→29mb)，大幅提升启动速度(2.6s→1.1s)<br>4.优化部分功能逻辑</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">5.7版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>(Optional可选更新，不会推送)<br>2023.11.11<br>1.使用nuitka方法代替pyinstaller，大幅降低启动时间(5.6启动2.3秒，5.7启动1.1秒)，也减少了空间占用<br>2.由于nuitka下pygame库大量调用wind32api、wind2con等会导致杀毒软件误报，请信任处理<br>3.此版本仅做优化，没有任何新功能，可选择性升级<br>4.修复统计历史记录时，关闭弹窗仍会保存为文本的问题<br>5.在nuitka中，使用了 --windows-uac-admin方法，使提权代码不再必须<br>6.调整了一些弹窗逻辑</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">5.6版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2023.10.13<br>1.优化多名单体验<br>2.新增检查更新开关，Allowcheck.ini文件中改为0就可以关闭检查更新<br>3.调整部分按钮功能<br>4.优化界面<br>5.精简打包输出</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">5.52版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2023.10.12<br>1.修复多名单选择后未切换问题(该死的Global忘记加上去了)<br>2.新增检查更新开关Allowcheck.ini文件中改为0就可以关闭检查更新<br>3.优化首次启动界面</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>下载地址https://yish.lanzouw.com/b038hjo8f<br>密码:cmti</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading"><s>5.5版本发布说明</s></h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"textColor":"vivid-red"} -->
<p class="has-vivid-red-color has-text-color">5.5版本多名单存在严重BUG导致切换名单，正在紧急修复，稍后推送5.52版本，请不要再使用5.5版本</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><s>2023.10.9<br>1.修复多名单选择窗口未按预期显示<br>2.调整布局<br>3.更换检查更新api<br>已知问题<br>1.首次运行的弹窗未适配高dpi<br>2.导出历史记录时选择关闭，会默认选择导出到文本<br>以上问题不会影响体验，将于下个版本中修复</s></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"style":{"typography":{"fontSize":"28px"}}} -->
<h2 class="wp-block-heading" style="font-size:28px">5.4 测试版发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"style":{"typography":{"fontSize":"17px"}}} -->
<p style="font-size:17px">2023.9.10<br>1.新增多名单功能<br>已知问题<br>1.首次打开可能报错（已修复）<br>2.首次打开会有一个空的选择名单界面，关闭即可、<br>3.每次打开都会出现选择名单的界面（即使只有一个名单）<br></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">5.3版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2023.6.25</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>1.优化弹窗逻辑<br>2.优化高DPi的ui布局<br>3.新增背景音乐文件按钮</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>为了统计名单，程序使用了提权代码，可能被杀毒软件误杀，如有疑问请查看<a rel="noreferrer noopener" href="https://github.com/Yish1/Class-Roster-Picker/blob/main/main.py" data-type="URL" data-id="https://github.com/Yish1/Class-Roster-Picker/blob/main/main.py" target="_blank">源码</a></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading"><strong>5.2版本发布说明</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2023.6.23</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>1.新增名单中奖统计功能，并支持导出为图表或文本</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>2.优化背景音乐体验</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>3.修复大量BUG</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>4.优化弹窗代码</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>5.一定程度上优化跨平台（Linux系统）的支持</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>linux请使用5.1获得完整适配</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>6.点名器已经没有什么更新空间了，后续会制作其它的小工具，感谢各位的支持！</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"style":{"typography":{"fontSize":"28px"}}} -->
<h2 class="wp-block-heading" style="font-size:28px">5.1版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>此版本更新内容与5.2相同，但提供了完整的Linux系统支持（感谢limuy2022），5.2更适用于Windows平台</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Yish1/Class-Roster-Picker/releases/download/5.2/5.1.linux_x86.zip" data-type="URL" data-id="https://github.com/Yish1/Class-Roster-Picker/releases/download/5.2/5.1.linux_x86.zip" target="_blank" rel="noreferrer noopener">5.1下载</a></p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"style":{"typography":{"fontSize":"28px"}}} -->
<h2 class="wp-block-heading" style="font-size:28px">5.0版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>5.0版本更新内容2022.12.22<br>1.调整UI布局以便显示更长名字<br>2.优化弹窗<br>3.新增单抽时背景音乐，开启方式请查看文件目录下的说明<br>4.新增名单长度读取<br>5.精简代码<br>软件完全免费并开源，意味着任何人都能查看这个工具的源代码，如果你是付费购买的，那说明你已经被骗了，请尝试立即退款并举报<br>经网友反馈360可能会误杀此工具，请将点名器加入信任区（开源软件，代码供网友随时检查）</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.9版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.10.3<br>1.调整UI颜色<br>2.优化部分弹窗提示效果<br>3.优化更新提示<br>4.优化连抽体验<br>5.精简代码</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.8版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.10.1<br>1.新增桌面高考倒计时(仅限定制版，通用版没有)<br>2.进一步修复高DPi问题<br>3.优化自动更新体验<br>4.更换打包方式，使程序更快启动</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.7版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.9.25<br>1.新增自动检查更新<br>2.优化体验</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.6版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.9.24<br>1.修复高DPI/4K分辨率下的崩溃问题，但在过高分辨率或DPI下仍会出现字体大小异常的问题 （暂无修复计划）<br>2.修复某些情况下无法修改名单的问题<br>3.优化界面和提示语<br>4.更改打包方式，提高运行速度</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p><iframe src="//player.bilibili.com/player.html?bvid=BV1ge4y1a7Q4&amp;page=1" frameborder="no" scrolling="no" allowfullscreen="allowfullscreen"> </iframe></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"fontSize":"medium"} -->
<h2 class="wp-block-heading has-medium-font-size"><strong>3.99版本更新内容</strong></h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><strong>2022.8.13</strong></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size"><strong><em>此更新3.99仅限13班定制版点名器，其余版本仍为3.90-3.95（3.90到3.95内容完全一样）</em></strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>①修复图标过于模糊的问题</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>②修复连抽区间在43-100内无效的问题</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>③优化UI间隙</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"fontSize":"medium"} -->
<h2 class="wp-block-heading has-medium-font-size"><strong>3.9 </strong>版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><strong>2022.8.12</strong></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">①增大界面，增大字体，使文字能更好的在大屏幕上展示</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">②缓解了高DPI模式下无法完全显示文字的问题(还可以手动在电脑设置中将屏幕缩放比例调整至100%解决此问题)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">③优化了连抽模式的体验</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"fontSize":"medium"} -->
<h2 class="wp-block-heading has-medium-font-size">3.0版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>2022.7.29</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">①全新界面，新增连抽和历史记录</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">②真随机抽取</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">2022.6 2.0首个版本</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">关于</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>这个点名器源码来自<a rel="noreferrer noopener" href="https://blog.csdn.net/hhladminhhl" target="_blank">Dragon少年</a> 基于Python：pyqt5，我Yish_(高三)和<a href="https://hltool.top/ktdmq-yish/">QQB(高二)</a> ，<a href="https://github.com/limuy2022">limuy2022</a>（初三）制作</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>可以每次单人抽取也可以自己选择连抽人数进行多人连抽，并将这些随机抽取的学生姓名历史数据显示，能够活跃课堂氛围，排除主观因素，真正做到随机点名。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><s>但由于技术原因，在连续抽取模式下，暂时无法做到不重复。</s>已被limuy2022修复</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>制作：Yish_ ，QQB，limuy2022</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://www.bilibili.com/video/BV1ge4y1a7Q4/">https://www.bilibili.com/video/BV1ge4y1a7Q4/</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://blog.csdn.net/hhladminhhl/article/details/120521112">一起用Python做个上课点名器，好玩又实用！_Dragon少年的博客-CSDN博客_python点名器</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://hltool.top/ktdmq-yish/">课堂点名器 – QQB's Blog (hltool.top)</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Yish1/ktdmq">Yish1/ktdmq: 课堂点名器 (github.com)</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"fontSize":"large"} -->
<h2 class="wp-block-heading has-large-font-size">更改名单</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size"><strong>名单：首次打开后将自动在目录下生成名单.txt，您需要手动将里面的数字替换成点名的名单，格式为一行一个名字！！！</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"fontSize":"large"} -->
<h2 class="wp-block-heading has-large-font-size">定制版本</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size"><strong>定制版本名单封装至程序内，无法修改名单！！！您可以通过邮箱联系我获取定制版，这是免费的</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size"></p>
<!-- /wp:paragraph -->

<!-- wp:image {"width":741,"height":646,"sizeSlug":"large"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://cdn.cmxz.top/images/dm/picture.png" alt="" width="741" height="646"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:columns -->
<div class="wp-block-columns"><!-- wp:column {"width":"100%"} -->
<div class="wp-block-column" style="flex-basis:100%"></div>
<!-- /wp:column --></div>
<!-- /wp:columns -->

<!-- wp:columns -->
<div class="wp-block-columns"><!-- wp:column {"width":"100%"} -->
<div class="wp-block-column" style="flex-basis:100%"><!-- wp:heading -->
<h2 class="wp-block-heading">5.6部分源码展示</h2>
<!-- /wp:heading --></div>
<!-- /wp:column --></div>
<!-- /wp:columns -->

<!-- wp:code -->
<pre class="wp-block-code"><code>def name_list_selector():
    global txtnum, name_list, file_path, namefolder, mdnum
    namefolder = "name"
    namefolder1 = os.path.dirname(os.path.abspath(__file__))
    namefolder_path = os.path.join(namefolder1, namefolder)
    if not os.path.exists(namefolder_path) or not os.path.isdir(namefolder_path):
        print(f"名单文件夹不存在，已经在这个位置创建：{namefolder_path}")
        os.makedirs(namefolder_path)
    txtnum = &#91;filename for filename in os.listdir(namefolder) if filename.endswith(".txt")]
    ifonefile = f"{namefolder_path}\\{', '.join(txtnum)}"
    mdnum = len(txtnum)
    if not txtnum:
        name_list = list(make_name_list())
        init_name(name_list)
        app = QApplication(sys.argv)
        welcom = QMessageBox()
        welcom.setWindowTitle("欢迎使用")
        welcom.setText("欢迎使用沉梦课堂点名器！\n本程序支持单抽，连抽。同时提供单抽时背景音乐、多名单支持、数据导出等功能。\n\n请及时修改目录下的名单文件，请确保格式正确（将原本的1-20的数字删除，一行输入一个名字，像下面这样）：\n名字1\n名字2\n名字3\n名字4\n名字5\n名字6\n......\n\n需要帮助请点击关于。\n\n沉梦小站")
        # 设置消息框的图标和按钮
        welcom.setIconPixmap(QIcon('yish.ico').pixmap(64, 64))  # 64x64 大小的图标
        welcom.setStandardButtons(QMessageBox.Ok)
        welcom.exec_()
        opentext(name_path)
        print("这应该是首次启动")

    if mdnum &gt; 0:
        # 创建窗口和UI元素
        app1 = QApplication(&#91;])
        window = QWidget()
        window.setWindowTitle('选择名单')
        window.setGeometry(100, 100, 500, 200)
        layout = QVBoxLayout()
        combo_box = QComboBox(window)
        custom_list_view = QListView(combo_box)
        combo_box.setFixedHeight(40)
        custom_list_view.setStyleSheet("QListView::item { height: 40px; }")
        combo_box.setView(custom_list_view)
        layout.addWidget(combo_box)
        button = QPushButton('确定', window)
        button.setFixedHeight(40)
        layout.addWidget(button)
        window.setLayout(layout)
        screen = QDesktopWidget().screenGeometry()
        window_width, window_height = window.sizeHint().width(), window.sizeHint().height()
        x = int((screen.width() - window_width) // 2.25)
        y = int((screen.height() - window_height) // 2.25)
        window.setGeometry(x, y, 500, 200)
        add_button = QPushButton('新增名单', window)
        add_button.setFixedHeight(40)
        layout.addWidget(add_button)
        delete_button = QPushButton('删除名单', window)
        delete_button.setFixedHeight(40)
        layout.addWidget(delete_button)

        def add_new_list():
            newfilename, ok_pressed = QInputDialog.getText(window, "新增名单", "请输入名单名称:")
            if ok_pressed and newfilename:
                print(f"新增名单名称是: {newfilename}")
                newnamepath = os.path.join("name", f"{newfilename}.txt")# 打开文件并写入内容
                with open(newnamepath, "w", encoding="utf8") as f:
                    pass
                message = f"已创建名为 '{newfilename}.txt' 的文件，路径为: {newnamepath}"
                QMessageBox.information(window, "新建成功", message, QMessageBox.Ok)
                opentext(newnamepath)
                txtnum = &#91;filename for filename in os.listdir("name") if filename.endswith(".txt")]
                combo_box.clear()  # 清空下拉框的选项
                combo_box.addItems(txtnum)  # 添加新的文件名到下拉框
        add_button.clicked.connect(add_new_list)
        
        def delete_list():
            target_filename, ok_pressed = QInputDialog.getText(window, "删除名单", "请输入要删除的名单名称:")
            if ok_pressed and target_filename:
                target_filepath = os.path.join("name", f"{target_filename}.txt")
                if os.path.exists(target_filepath):
                    os.remove(target_filepath)  # 删除文件
                    message = f"已成功删除名为 '{target_filename}.txt' 的文件。"
                    QMessageBox.information(window, "删除成功", message, QMessageBox.Ok)
                    txtnum = &#91;filename for filename in os.listdir("name") if filename.endswith(".txt")]
                    combo_box.clear()  # 清空下拉框的选项
                    combo_box.addItems(txtnum)  # 添加新的文件名到下拉框
                else:
                    QMessageBox.warning(window, '警告', '名单文件不存在', QMessageBox.Ok)
        delete_button.clicked.connect(delete_list)

        combo_box.addItems(txtnum)
        def showlist():
            global selected_file,file_path
            selected_file = combo_box.currentText()
            file_path = os.path.join("name", selected_file)
            if not os.path.exists(file_path):
                QMessageBox.warning(window, '警告', '名单文件不存在', QMessageBox.Ok)
            else:
                print(f"所选文件的路径为: {file_path}")
                window.close()
        button.clicked.connect(showlist)
        # 显示窗口
        window.show()
        app1.exec_()
    else:
        pass

if __name__ == '__main__':
    name_list_selector()</code></pre>
<!-- /wp:code -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Yish1/ktdmq">Yish1/ktdmq: 课堂点名器 (github.com)</a></p>
<!-- /wp:paragraph -->

<!-- wp:verse {"fontSize":"medium"} -->
<pre class="wp-block-verse has-medium-font-size"></pre>
<!-- /wp:verse -->
