<!-- wp:heading {"style":{"typography":{"fontSize":"28px"}}} -->
<h2 class="wp-block-heading" style="font-size:28px">5.4 测试版发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">2023.9.8<br>1.新增多名单功能<br>已知问题<br>1.首次打开可能报错（9.10已修复）<br>2.首次打开会有一个空的选择名单界面，关闭即可<br>3.每次打开都会出现选择名单的界面（即使只有一个名单）<br>其中2和3由于 self.close代码不起作用而无法修复，正在排查问题，欢迎查看源码协助我们修复</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>https://yish.lanzouw.com/iGTPM17xdceb密码:3b7i</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">5.3版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2023.6.25</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>1.优化弹窗逻辑<br>2.优化高DPi的ui布局<br>3.新增背景音乐文件按钮</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>为了统计名单，程序使用了提权代码，可能被杀毒软件误杀，如有疑问请查看<a rel="noreferrer noopener" href="https://github.com/Yish1/Class-Roster-Picker/blob/main/main.py" data-type="URL" data-id="https://github.com/Yish1/Class-Roster-Picker/blob/main/main.py" target="_blank">源码</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"style":{"typography":{"fontSize":"28px"}}} -->
<p style="font-size:28px"><a rel="noreferrer noopener" href="https://yish.lanzouw.com/b038hjo8f" data-type="URL" data-id="https://yish.lanzouw.com/b038hjo8f" target="_blank"><strong>最新版下载地址</strong></a>密码:cmti</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"style":{"typography":{"fontSize":"28px"}}} -->
<p style="font-size:28px"><a href="https://yish.lanzouw.com/ixZmq10g004h" data-type="URL" data-id="https://yish.lanzouw.com/ixZmq10g004h" target="_blank" rel="noreferrer noopener"><strong>5.3下载链接2（安装包）</strong></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size">更新时请备份名单，然后卸载旧版本重新安装，否则可能出现错误</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"style":{"typography":{"fontSize":"28px"}}} -->
<p style="font-size:28px"><strong><a rel="noreferrer noopener" href="https://yish.lanzouw.com/izsZF0fv96jg" data-type="URL" data-id="https://yish.lanzouw.com/izsZF0fv96jg" target="_blank">下载通用版4.9（最后的单文件版）</a></strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>下载4.6（最后的32位版本）</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph {"textColor":"vivid-red"} -->
<p class="has-vivid-red-color has-text-color">提示：4.8起更换了打包方式，改成安装包的形式，因此你可以在安装4.8后删除4.7，也可以安装到u盘里面便携使用</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"textColor":"vivid-cyan-blue","fontSize":"large"} -->
<p class="has-vivid-cyan-blue-color has-text-color has-large-font-size"><strong>4.6版本后暂不支持32位系统！！！</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>旧版本支持32位系统<a href="https://github.com/Yish1/ktdmq/releases/download/4.3/4.3.exe">https://github.com/Yish1/ktdmq/releases/download/4.3/4.3.exe</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading"><strong>5.2版本发布说明</strong></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2023.6.23</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>1.新增名单中奖统计功能，并支持导出为图表或文本</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>2.优化背景音乐体验</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>3.修复大量BUG</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>4.优化弹窗代码</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>5.一定程度上优化跨平台（Linux系统）的支持</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>linux请使用5.1获得完整适配</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>6.点名器已经没有什么更新空间了，后续会制作其它的小工具，感谢各位的支持！</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"style":{"typography":{"fontSize":"28px"}}} -->
<h2 class="wp-block-heading" style="font-size:28px">5.1版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>此版本更新内容与5.2相同，但提供了完整的Linux系统支持（感谢limuy2022），5.2更适用于Windows平台</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Yish1/Class-Roster-Picker/releases/download/5.2/5.1.linux_x86.zip" data-type="URL" data-id="https://github.com/Yish1/Class-Roster-Picker/releases/download/5.2/5.1.linux_x86.zip" target="_blank" rel="noreferrer noopener">5.1下载</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"style":{"typography":{"fontSize":"28px"}}} -->
<h2 class="wp-block-heading" style="font-size:28px">5.0版本发布说明</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>5.0版本更新内容2022.12.22<br>1.调整UI布局以便显示更长名字<br>2.优化弹窗<br>3.新增单抽时背景音乐，开启方式请查看文件目录下的说明<br>4.新增名单长度读取<br>5.精简代码<br>软件完全免费并开源，意味着任何人都能查看这个工具的源代码，如果你是付费购买的，那说明你已经被骗了，请尝试立即退款并举报<br>经网友反馈360可能会误杀此工具，请将点名器加入信任区（开源软件，代码供网友随时检查）</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.9版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.10.3<br>1.调整UI颜色<br>2.优化部分弹窗提示效果<br>3.优化更新提示<br>4.优化连抽体验<br>5.精简代码</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.8版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.10.1<br>1.新增桌面高考倒计时(仅限定制版，通用版没有)<br>2.进一步修复高DPi问题<br>3.优化自动更新体验<br>4.更换打包方式，使程序更快启动</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.7版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.9.25<br>1.新增自动检查更新<br>2.优化体验</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">4.6版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>2022.9.24<br>1.修复高DPI/4K分辨率下的崩溃问题，但在过高分辨率或DPI下仍会出现字体大小异常的问题 （暂无修复计划）<br>2.修复某些情况下无法修改名单的问题<br>3.优化界面和提示语<br>4.更改打包方式，提高运行速度</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:paragraph -->
<p><iframe src="//player.bilibili.com/player.html?bvid=BV1ge4y1a7Q4&amp;page=1" frameborder="no" scrolling="no" allowfullscreen="allowfullscreen"> </iframe></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"fontSize":"medium"} -->
<h2 class="wp-block-heading has-medium-font-size"><strong>3.99版本更新内容</strong></h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><strong>2022.8.13</strong></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size"><strong><em>此更新3.99仅限13班定制版点名器，其余版本仍为3.90-3.95（3.90到3.95内容完全一样）</em></strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>①修复图标过于模糊的问题</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>②修复连抽区间在43-100内无效的问题</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>③优化UI间隙</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"fontSize":"medium"} -->
<h2 class="wp-block-heading has-medium-font-size"><strong>3.9 </strong>版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><strong>2022.8.12</strong></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">①增大界面，增大字体，使文字能更好的在大屏幕上展示</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">②缓解了高DPI模式下无法完全显示文字的问题(还可以手动在电脑设置中将屏幕缩放比例调整至100%解决此问题)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">③优化了连抽模式的体验</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"fontSize":"medium"} -->
<h2 class="wp-block-heading has-medium-font-size">3.0版本更新内容</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>2022.7.29</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">①全新界面，新增连抽和历史记录</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">②真随机抽取</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size">2022.6 2.0首个版本</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 class="wp-block-heading">关于</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>这个点名器源码来自<a rel="noreferrer noopener" href="https://blog.csdn.net/hhladminhhl" target="_blank">Dragon少年</a> 基于Python：pyqt5，我Yish_(高三)和<a href="https://hltool.top/ktdmq-yish/">QQB(高二)</a> ，<a href="https://github.com/limuy2022">limuy2022</a>（初三）制作</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>可以每次单人抽取也可以自己选择连抽人数进行多人连抽，并将这些随机抽取的学生姓名历史数据显示，能够活跃课堂氛围，排除主观因素，真正做到随机点名。</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><s>但由于技术原因，在连续抽取模式下，暂时无法做到不重复。</s>已被limuy2022修复</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>制作：Yish_ ，QQB，limuy2022</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://www.bilibili.com/video/BV1ge4y1a7Q4/">https://www.bilibili.com/video/BV1ge4y1a7Q4/</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://blog.csdn.net/hhladminhhl/article/details/120521112">一起用Python做个上课点名器，好玩又实用！_Dragon少年的博客-CSDN博客_python点名器</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://hltool.top/ktdmq-yish/">课堂点名器 – QQB's Blog (hltool.top)</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Yish1/ktdmq">Yish1/ktdmq: 课堂点名器 (github.com)</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator has-alpha-channel-opacity"/>
<!-- /wp:separator -->

<!-- wp:heading {"fontSize":"large"} -->
<h2 class="wp-block-heading has-large-font-size">更改名单</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size"><strong>名单：首次打开后将自动在目录下生成名单.txt，您需要手动将里面的数字替换成点名的名单，格式为一行一个名字！！！</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"fontSize":"large"} -->
<h2 class="wp-block-heading has-large-font-size">定制版本</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"textColor":"vivid-red","fontSize":"medium"} -->
<p class="has-vivid-red-color has-text-color has-medium-font-size"><strong>定制版本名单封装至程序内，无法修改名单！！！您可以通过邮箱联系我获取定制版，这是免费的</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"medium"} -->
<p class="has-medium-font-size"></p>
<!-- /wp:paragraph -->

<!-- wp:image {"width":741,"height":646,"sizeSlug":"large"} -->
<figure class="wp-block-image size-large is-resized"><img src="https://cdn.cmxz.top/images/dm/picture.png" alt="" width="741" height="646"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:columns -->
<div class="wp-block-columns"><!-- wp:column {"width":"100%"} -->
<div class="wp-block-column" style="flex-basis:100%"></div>
<!-- /wp:column --></div>
<!-- /wp:columns -->

<!-- wp:columns -->
<div class="wp-block-columns"><!-- wp:column {"width":"100%"} -->
<div class="wp-block-column" style="flex-basis:100%"><!-- wp:heading -->
<h2 class="wp-block-heading">5.1部分源码展示</h2>
<!-- /wp:heading --></div>
<!-- /wp:column --></div>
<!-- /wp:columns -->

<!-- wp:code -->
<pre class="wp-block-code"><code>   def countname(self):
        name_counts = {}  # 存储名字出现次数的字典
        with open("点名器中奖名单.txt") as file:
            for line in file:
                if "幸运儿是：" in line:
                    cnames = line.split("幸运儿是：")&#91;1].strip().strip("&#91;]'")
                    cnames = cnames.split("', '")
                    for cname in cnames:
                        if cname not in name_counts:
                            name_counts&#91;cname] = 1
                        else:
                            name_counts&#91;cname] += 1
        sorted_counts = sorted(name_counts.items(), key=lambda x: x&#91;1], reverse=True)
        names = &#91;name for name, count in sorted_counts]
        counts = &#91;count for name, count in sorted_counts]
        # 生成柱状图
        plt.rcParams&#91;"font.family"] = "Microsoft YaHei"
        plt.style.use("dark_background")
        fig, ax = plt.subplots(figsize=(7680 / 300, 4320 / 300))
        bars = ax.bar(names, counts, color="cyan")
        ax.bar_label(bars, fmt="%d", fontsize=12)  # 在柱子上方标记数据
        ax.set_xlabel("名字")
        ax.set_ylabel("次数")
        ax.set_title("点名器中奖统计", fontsize=24)  # 设置标题字体大小
        ax.tick_params(axis="x", rotation=90)
        # 弹窗选择保存选项
        msg_box = QMessageBox()
        msg_box.setWindowTitle("保存选项")
        msg_box.setText("请选择保存方式")
        save_button = msg_box.addButton("保存为柱形图", QMessageBox.YesRole)
        cancel_button = msg_box.addButton("保存为文本", QMessageBox.NoRole)
        msg_box.setDefaultButton(cancel_button)
        msg_box.exec_()
        if msg_box.clickedButton() == save_button:
            # 保存图表
            plt.savefig("中奖统计图.png")
            QMessageBox.information(self, "保存结果", "图表已保存到'中奖统计图.png'")
            plt.show()
        elif msg_box.clickedButton() == cancel_button:
            # 保存文本
            cresult = "中奖名单统计(统计会覆盖上一次结果):\n"
            for name, count in sorted_counts:
                cresult += f"{name} 出现了 {count} 次\n"
            with open("中奖统计.txt", "w") as file:
                file.write(cresult)
            QMessageBox.information(self, "保存结果", "统计结果已保存到'中奖统计.txt'")
            opentext("./中奖统计.txt")</code></pre>
<!-- /wp:code -->

<!-- wp:paragraph -->
<p>----------------------------------------------</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><a href="https://github.com/Yish1/ktdmq">Yish1/ktdmq: 课堂点名器 (github.com)</a></p>
<!-- /wp:paragraph -->

<!-- wp:verse {"fontSize":"medium"} -->
<pre class="wp-block-verse has-medium-font-size"></pre>
<!-- /wp:verse -->
